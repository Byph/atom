(function(){function e(a){return typeof a=="object"}function g(a,b){for(var c=a.length;--c>=0;)if(a[c]===b)return!0}function h(a){return f(a)?a:[a]}function i(a,b,c,d){var e=f(b),g=e?b:[b],h,i=[],j=a.props;for(var k=g.length;--k>=0;){h=g[k];if(d&&!j.hasOwnProperty(h))return;i.unshift(j[h])}return c?c.apply({},i):e?i:i[0]}function j(a,b){for(var c=a.length;--c>=0;)if(!a[c].calls)return a.splice(c,1)}function k(a,b,c){var d,e,f=a.listeners,h=[].concat(f),k,l,m=a.props,n=m[b],o=m.hasOwnProperty(b);m[b]=c;if(!o||n!==c||c&&typeof c=="object"){for(var p=h.length;--p>=0;){e=h[p],d=e.keys,k=e.all;if(g(d,b)){l=i(a,d,null,k);if(l||!k)e.cb.apply({},l),e.calls--;e.calls||j(f,e)}}delete a.needs[b]}}function l(a,b,c){c(function(c){k(a,b,c)})}var a=this,b={VERSION:"0.0.4"},c=a.atom;typeof module!="undefined"&&module.exports&&(module.exports=b),a.atom=b,b.noConflict=function(){return a.atom=c,this};var d=Array.prototype.slice,f=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};b.create=function(){function n(){m&&(m.pending=m.next=!m.next&&m.length?m.shift():m.next,m.args=d.call(arguments,0),m.pending&&(m.next=null,m.pending.apply({},[n].concat(m.args))))}var a={props:{},needs:{},providers:{},listeners:[]},b=a.props,c=a.needs,g=a.providers,j=a.listeners,m=[],o={bind:function(a,b){j.unshift({keys:h(a),cb:b,all:!1,calls:Infinity})},chain:function(){if(m)for(var a=0,b=arguments.length;a<b;a++)m.push(arguments[a]),m.pending||n.apply({},m.args)},destroy:function(){delete a.props,delete a.needs,delete a.providers,delete a.listeners;while(m.length)m.pop();a=b=c=g=j=m=m.pending=m.next=m.args=null},each:function(a,b){var c=h(a),d=-1,e=c.length,f;while(++d<e)f=c[d],b(f,o.get(f))},entangle:function(a,b){var c=f(b),d=!c&&e(b),g,h,i=c?b:d?[]:[b],j=d?b:{};if(d)for(h in j)j.hasOwnProperty(h)&&i.push(h);else for(g=i.length;--g>=0;)h=i[g],j[h]=h;o.each(i,function(b){var c=j[b];o.bind(b,function(b){a.set(c,b)}),a.bind(c,function(a){o.set(b,a)})})},get:function(b,c){return i(a,b,c)},has:function(a){var c=h(a);for(var d=c.length;--d>=0;)if(!b.hasOwnProperty(c[d]))return!1;return!0},keys:function(){var a=[];for(var c in b)b.hasOwnProperty(c)&&a.push(c);return a},mixin:function(a){for(var b in a)a.hasOwnProperty(b)&&(o[b]=a[b]);return o},need:function(d,e){var f,i=h(d),j,k;for(var m=i.length;--m>=0;)f=i[m],k=g[f],!b.hasOwnProperty(f)&&k?(l(a,f,k),delete g[f]):c[f]=!0;o.once(i,e)},next:function(a,b){j.unshift({keys:h(a),cb:b,all:!1,calls:1})},once:function(b,c){var d=h(b),e=i(a,d,null,!0);e?c.apply({},e):j.unshift({keys:d,cb:c,all:!0,calls:1})},provide:function(b,d){c[b]?l(a,b,d):g[b]||(g[b]=d)},set:function(b,c){if(e(b))for(var d in b)b.hasOwnProperty(d)&&k(a,d,b[d]);else k(a,b,c)},unbind:function(a){for(var b=j.length;--b>=0;)j[b].cb===a&&j.splice(b,1)}};return o}})()
